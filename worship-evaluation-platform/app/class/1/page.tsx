"use client"

import { useState } from "react"
import { Button } from "@/components/ui/button"
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from "@/components/ui/card"
import { RadioGroup, RadioGroupItem } from "@/components/ui/radio-group"
import { Label } from "@/components/ui/label"
import { Textarea } from "@/components/ui/textarea"
import { Progress } from "@/components/ui/progress"
import { BookOpen, CheckCircle, ArrowLeft, ArrowRight, Heart, Cross } from "lucide-react"

const mockClass = {
  id: 1,
  title: "¿Qué es la adoración verdadera?",
  pillar: "Identidad del adorador y Fundamento Espiritual",
  premise:
    "La adoración es mucho más que un acto musical; es un estilo de vida que fluye desde el corazón de cada creyente, va más allá de la música, y cómo debe ser una constante en nuestra relación con Dios.",
  objective: "Entender que la adoración verdadera es un estilo de vida y no un momento aislado.",
  reflection:
    "Los participantes deben comprometerse a vivir una vida de adoración más allá de la plataforma, cultivando su relación con Dios en lo secreto.",
  focus:
    "Más allá de la música. Adorar en espíritu y verdad implica intimidad, obediencia y entrega a Dios en todas las áreas de la vida.",
  bibleBase: "Juan 4:23-24, Génesis 22:5",
  content: `
# Volver al Altar: Adorar es Vivir

## Introducción
Muchos confunden adoración con cantar. Pero la adoración verdadera no comienza con música ni termina con aplausos. Comienza con una vida rendida, y termina cuando todo en ti arde para Dios.

Jesús le habló a una mujer rota, sola y confundida, y le reveló algo poderoso: **"El Padre busca adoradores en espíritu y en verdad"** (Juan 4:23-24). No le habló a los fariseos, ni a los músicos, ni a los expertos… sino a alguien que necesitaba volver al altar.

Hoy, Dios no busca talento. Busca entrega. Busca fuego verdadero.

## Versículos Clave para Considerar

### Juan 4:23-24
*"Pero la hora viene, y ahora es, cuando los verdaderos adoradores adorarán al Padre en espíritu y en verdad; porque también el Padre tales adoradores busca que le adoren. Dios es Espíritu; y los que le adoran, en espíritu y en verdad es necesario que adoren."*

### Romanos 12:1
*"Así que, hermanos, os ruego por las misericordias de Dios, que presentéis vuestros cuerpos en sacrificio vivo, santo, agradable a Dios, que es vuestro culto racional."*

### Salmo 51:16-17
*"Porque no quieres sacrificio, que yo lo daría; no quieres holocausto. Los sacrificios de Dios son el espíritu quebrantado; al corazón contrito y humillado no despreciarás tú, oh Dios."*

### Mateo 15:8-9
*"Este pueblo de labios me honra; mas su corazón está lejos de mí. Pues en vano me honran, enseñando como doctrinas mandamientos de hombres."*

## 1. La adoración comienza con rendición (Génesis 22:5)

Abraham no subió al monte con una banda. Subió con su hijo. Subió con obediencia. Dijo: **"Iremos, adoraremos y volveremos"** (Génesis 22:5). Su adoración fue una entrega, no una canción.

### Reflexiones clave:
- **"Dios no quiere tu música si no tiene tu corazón"**
- **"No hay fuego sin altar. No hay presencia sin entrega"**
- **"El altar no es performance, es rendición"**

Cuando adoramos sin rendirnos, solo ofrecemos sonido. Pero cuando entregamos todo… ofrecemos incienso.

## 2. En espíritu: Adorar desde lo profundo, no desde lo superficial

### Salmos 42:1-2
*"Como el ciervo brama por las corrientes de las aguas, así clama por ti, oh Dios, el alma mía. Mi alma tiene sed de Dios, del Dios vivo; ¿cuándo vendré, y me presentaré delante de Dios?"*

### Romanos 8:26
*"Y de igual manera el Espíritu nos ayuda en nuestra debilidad; pues qué hemos de pedir como conviene, no lo sabemos, pero el Espíritu mismo intercede por nosotros con gemidos indecibles."*

Jesús no pidió adoradores expertos. Pidió adoradores en espíritu. Esto es: con profundidad, desde lo íntimo, desde lo que nadie más ve.

### Verdades transformadoras:
- **"No te conviertes en adorador en la iglesia. Te conviertes en tu cuarto"**
- **"No necesitas música para eso, solo necesitas hambre"**

Adorar en espíritu no es cantar bonito. Es vivir conectado. Respirar consciente de Dios. Es que tu espíritu le diga al suyo: 'Sin ti, no puedo vivir'.

## 3. En verdad: Con coherencia, sin máscaras

Dios busca adoración real. No se trata de sonar lindo, sino de ser verdadero.

### Preguntas desafiantes:
- ¿Lo que cantas es lo que vives?
- Lo que adoras en lo secreto se nota en lo público
- Si cantas 'te amo', pero no le obedeces… ¿es amor o emoción?

Adorar en verdad es vivir en integridad. Es que tu adoración sea el eco de tu obediencia diaria.

## La Realidad de la Adoración Verdadera

Adorar no es agarrar un micrófono ni cantar bonito. La adoración real no empieza con la música… empieza en el corazón. Puedes levantar las manos en la iglesia el domingo y tener cero conexión con Dios el resto de la semana. Y eso, se nota.

Dios no está buscando gente que solo se sepa la letra o que suene bien. Está buscando personas rendidas de verdad, que hablen con Él en lo secreto, que lo escuchen, que lo obedezcan incluso cuando nadie los está viendo.

### Porque la adoración real no se finge:
- Si hay orgullo, sube el orgullo
- Si hay doble vida, sube eso
- Si hay entrega, pasión y sinceridad… eso es lo que llega al cielo

Jesús no está midiendo tu volumen. Está mirando cuánto de ti le estás dando.

## Parábola: "Los espejos ocultos"

En una casa grande, vivía una familia de muchos hermanos. Cada uno tenía un espejo en su habitación. Algunos lo limpiaban todos los días; otros, solo cuando sabían que alguien iba a entrar.

Pero lo que no sabían… era que las paredes de la casa estaban llenas de espejos invisibles, puestos por el Padre de familia. No eran para exponer, sino para revelar el corazón.

Un día, el Padre los reunió y les dijo con amor:

*"Hijos, ustedes ven lo que los demás hacen… pero Yo veo lo que ustedes piensan. Veo cuando uno ignora al otro, cuando finge respeto, cuando sonríe pero en su mente critica. Yo escucho lo que nunca se dice en voz alta, y conozco los planes que se arman en silencio."*

Uno de los hijos preguntó:
—*"¿Pero si el otro no lo sabe, acaso le estoy haciendo daño?"*

Y el Padre respondió:
*"No solo haces daño a tu hermano… Me lo haces a Mí. Porque cada uno de ustedes representa una parte de Mí. Y si no puedes honrar la parte que ves, ¿cómo me dirás que Me amas a Mí, que no ves?"*

Desde ese día, los hijos comenzaron a limpiar no solo los espejos de sus habitaciones… sino también los de su corazón.

## Conclusión

Tu vida entera es un altar. Pero no todo altar tiene fuego. Dios no busca más canciones. Busca más corazones rendidos. Él no se impresiona con tu volumen, sino con tu entrega.

Hoy, Dios está tocando tu puerta. No para invitarte a cantar… sino a rendirte.

**Hoy, vuelve al altar. Vuelve al fuego. Vuelve a ser adorador.**
  `,
  evaluation: {
    questions: [
      {
        id: 1,
        type: "multiple-choice",
        question: "Según la lección, ¿cuál es la diferencia principal entre adoración y cantar?",
        options: [
          "La adoración requiere más talento musical",
          "La adoración es un estilo de vida que comienza con una vida rendida, no solo un acto musical",
          "Cantar es más importante que adorar",
          "No hay diferencia entre ambos",
        ],
        correct: 1,
      },
      {
        id: 2,
        type: "multiple-choice",
        question: "¿Qué buscó Abraham en el monte según Génesis 22:5?",
        options: [
          "Una experiencia musical",
          "Adorar a través de la entrega y obediencia",
          "Impresionar a Dios con su fe",
          "Encontrar una nueva canción",
        ],
        correct: 1,
      },
      {
        id: 3,
        type: "multiple-choice",
        question: "Según Juan 4:23-24, ¿qué tipo de adoradores busca el Padre?",
        options: [
          "Adoradores talentosos",
          "Adoradores famosos",
          "Adoradores en espíritu y en verdad",
          "Adoradores con experiencia musical",
        ],
        correct: 2,
      },
      {
        id: 4,
        type: "essay",
        question:
          "Reflexiona sobre esta pregunta de la lección: '¿Estoy sobre el altar… o solo encima de la plataforma?' Explica la diferencia y cómo esto se aplica a tu vida de adoración.",
        minWords: 150,
      },
      {
        id: 5,
        type: "essay",
        question:
          "La lección menciona que 'No te conviertes en adorador en la iglesia. Te conviertes en tu cuarto.' ¿Cómo puedes desarrollar una vida de adoración en lo secreto? Describe prácticas específicas.",
        minWords: 120,
      },
      {
        id: 6,
        type: "essay",
        question:
          "Basándote en la parábola de 'Los espejos ocultos', reflexiona: ¿Cómo mis actitudes y pensamientos hacia otros afectan mi adoración a Dios? ¿Qué necesito cambiar?",
        minWords: 100,
      },
    ],
  },
}

export default function ClassPage() {
  const [currentSection, setCurrentSection] = useState<"content" | "evaluation">("content")
  const [answers, setAnswers] = useState<Record<number, string>>({})
  const [evaluationComplete, setEvaluationComplete] = useState(false)

  const handleAnswerChange = (questionId: number, answer: string) => {
    setAnswers((prev) => ({ ...prev, [questionId]: answer }))
  }

  const handleSubmitEvaluation = () => {
    setEvaluationComplete(true)
    alert("¡Evaluación enviada exitosamente! Tu puntuación estará disponible pronto.")
  }

  const progress =
    currentSection === "evaluation" ? (Object.keys(answers).length / mockClass.evaluation.questions.length) * 100 : 100

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-50 via-sky-50 to-slate-100">
      {/* Header */}
      <header className="bg-white border-b border-blue-200 shadow-sm">
        <div className="container mx-auto px-4 py-4">
          <div className="flex items-center gap-4">
            <Button
              variant="outline"
              size="sm"
              onClick={() => window.history.back()}
              className="border-blue-200 text-blue-600 hover:bg-blue-50"
            >
              <ArrowLeft className="h-4 w-4 mr-2" />
              Volver al Panel
            </Button>
            <div className="flex items-center gap-3">
              <div className="p-2 bg-blue-600 rounded-lg">
                <Cross className="h-6 w-6 text-white" />
              </div>
              <div>
                <h1 className="text-xl font-bold text-slate-800">
                  Sesión {mockClass.id}: {mockClass.title}
                </h1>
                <p className="text-blue-600">{mockClass.pillar}</p>
                <p className="text-sm text-slate-500 italic">{mockClass.bibleBase}</p>
              </div>
            </div>
          </div>
        </div>
      </header>

      <div className="container mx-auto px-4 py-8">
        {/* Class Overview */}
        <Card className="border-blue-200 bg-white mb-6">
          <CardHeader>
            <CardTitle className="text-slate-800 flex items-center gap-2">
              <Heart className="h-5 w-5 text-blue-600" />
              Resumen de la Sesión
            </CardTitle>
          </CardHeader>
          <CardContent className="space-y-4">
            <div>
              <h4 className="font-semibold text-slate-700">Premisa:</h4>
              <p className="text-slate-600">{mockClass.premise}</p>
            </div>
            <div>
              <h4 className="font-semibold text-slate-700">Objetivo:</h4>
              <p className="text-slate-600">{mockClass.objective}</p>
            </div>
            <div>
              <h4 className="font-semibold text-slate-700">Enfoque:</h4>
              <p className="text-slate-600">{mockClass.focus}</p>
            </div>
            <div>
              <h4 className="font-semibold text-slate-700">Reflexión:</h4>
              <p className="text-slate-600">{mockClass.reflection}</p>
            </div>
          </CardContent>
        </Card>

        {/* Progress Bar */}
        <Card className="border-blue-200 bg-white mb-6">
          <CardContent className="pt-6">
            <div className="flex justify-between items-center mb-2">
              <span className="text-sm font-medium text-slate-800">
                {currentSection === "content" ? "Progreso de Lectura" : "Progreso de Evaluación"}
              </span>
              <span className="text-sm text-blue-600">{Math.round(progress)}%</span>
            </div>
            <Progress value={progress} className="h-2" />
          </CardContent>
        </Card>

        {/* Navigation Tabs */}
        <div className="flex gap-4 mb-6">
          <Button
            variant={currentSection === "content" ? "default" : "outline"}
            onClick={() => setCurrentSection("content")}
            className={
              currentSection === "content"
                ? "bg-blue-600 hover:bg-blue-700"
                : "border-blue-200 text-blue-600 hover:bg-blue-50"
            }
          >
            <BookOpen className="h-4 w-4 mr-2" />
            Contenido de la Sesión
          </Button>
          <Button
            variant={currentSection === "evaluation" ? "default" : "outline"}
            onClick={() => setCurrentSection("evaluation")}
            className={
              currentSection === "evaluation"
                ? "bg-blue-600 hover:bg-blue-700"
                : "border-blue-200 text-blue-600 hover:bg-blue-50"
            }
          >
            <CheckCircle className="h-4 w-4 mr-2" />
            Evaluación
          </Button>
        </div>

        {/* Content Section */}
        {currentSection === "content" && (
          <Card className="border-blue-200 bg-white">
            <CardHeader>
              <CardTitle className="text-slate-800">Material de la Sesión</CardTitle>
              <CardDescription className="text-blue-600">
                Lee cuidadosamente el material antes de proceder a la evaluación
              </CardDescription>
            </CardHeader>
            <CardContent className="prose prose-blue max-w-none">
              <div className="text-slate-800 leading-relaxed space-y-4">
                {mockClass.content.split("\n").map((line, index) => {
                  if (line.startsWith("# ")) {
                    return (
                      <h1 key={index} className="text-3xl font-bold text-slate-800 mt-8 mb-4">
                        {line.substring(2)}
                      </h1>
                    )
                  } else if (line.startsWith("## ")) {
                    return (
                      <h2 key={index} className="text-2xl font-semibold text-slate-700 mt-6 mb-3">
                        {line.substring(3)}
                      </h2>
                    )
                  } else if (line.startsWith("### ")) {
                    return (
                      <h3 key={index} className="text-xl font-medium text-blue-700 mt-4 mb-2">
                        {line.substring(4)}
                      </h3>
                    )
                  } else if (line.startsWith("- ")) {
                    return (
                      <li key={index} className="text-slate-600 ml-4">
                        {line.substring(2)}
                      </li>
                    )
                  } else if (line.startsWith("*") && line.endsWith("*")) {
                    return (
                      <p
                        key={index}
                        className="text-blue-700 italic font-medium bg-blue-50 p-3 rounded-lg border-l-4 border-blue-300"
                      >
                        {line.substring(1, line.length - 1)}
                      </p>
                    )
                  } else if (line.includes("**") && line.split("**").length > 2) {
                    const parts = line.split("**")
                    return (
                      <p key={index} className="text-slate-600 mb-3">
                        {parts.map((part, partIndex) =>
                          partIndex % 2 === 1 ? (
                            <strong key={partIndex} className="text-blue-700 font-semibold">
                              {part}
                            </strong>
                          ) : (
                            part
                          ),
                        )}
                      </p>
                    )
                  } else if (line.trim() === "") {
                    return <br key={index} />
                  } else {
                    return (
                      <p key={index} className="text-slate-600 mb-3">
                        {line}
                      </p>
                    )
                  }
                })}
              </div>
              <div className="mt-8 pt-6 border-t border-blue-200">
                <Button onClick={() => setCurrentSection("evaluation")} className="bg-blue-600 hover:bg-blue-700">
                  Proceder a la Evaluación
                  <ArrowRight className="h-4 w-4 ml-2" />
                </Button>
              </div>
            </CardContent>
          </Card>
        )}

        {/* Evaluation Section */}
        {currentSection === "evaluation" && (
          <Card className="border-blue-200 bg-white">
            <CardHeader>
              <CardTitle className="text-slate-800">Evaluación de la Sesión</CardTitle>
              <CardDescription className="text-blue-600">
                Responde todas las preguntas para completar esta sesión. Tus respuestas serán calificadas
                automáticamente.
              </CardDescription>
            </CardHeader>
            <CardContent>
              {!evaluationComplete ? (
                <div className="space-y-6">
                  {mockClass.evaluation.questions.map((question, index) => (
                    <Card key={question.id} className="border-blue-100">
                      <CardHeader>
                        <CardTitle className="text-lg text-slate-800">
                          Pregunta {index + 1} de {mockClass.evaluation.questions.length}
                        </CardTitle>
                      </CardHeader>
                      <CardContent>
                        <p className="text-slate-700 mb-4 font-medium">{question.question}</p>

                        {question.type === "multiple-choice" && (
                          <RadioGroup
                            value={answers[question.id] || ""}
                            onValueChange={(value) => handleAnswerChange(question.id, value)}
                          >
                            {question.options?.map((option, optionIndex) => (
                              <div key={optionIndex} className="flex items-center space-x-2">
                                <RadioGroupItem value={optionIndex.toString()} id={`q${question.id}-${optionIndex}`} />
                                <Label htmlFor={`q${question.id}-${optionIndex}`} className="text-slate-600">
                                  {option}
                                </Label>
                              </div>
                            ))}
                          </RadioGroup>
                        )}

                        {question.type === "essay" && (
                          <div className="space-y-2">
                            <Textarea
                              placeholder="Escribe tu respuesta aquí..."
                              value={answers[question.id] || ""}
                              onChange={(e) => handleAnswerChange(question.id, e.target.value)}
                              className="min-h-32 border-blue-200 focus:border-blue-500"
                            />
                            <p className="text-sm text-blue-600">Mínimo {question.minWords} palabras requeridas</p>
                          </div>
                        )}
                      </CardContent>
                    </Card>
                  ))}

                  <div className="flex justify-between items-center pt-6">
                    <div className="text-sm text-blue-600">
                      {Object.keys(answers).length} de {mockClass.evaluation.questions.length} preguntas respondidas
                    </div>
                    <Button
                      onClick={handleSubmitEvaluation}
                      disabled={Object.keys(answers).length < mockClass.evaluation.questions.length}
                      className="bg-blue-600 hover:bg-blue-700 disabled:opacity-50"
                    >
                      Enviar Evaluación
                    </Button>
                  </div>
                </div>
              ) : (
                <div className="text-center py-12">
                  <CheckCircle className="h-16 w-16 text-green-600 mx-auto mb-4" />
                  <h3 className="text-2xl font-bold text-slate-800 mb-2">¡Evaluación Completada!</h3>
                  <p className="text-slate-600 mb-6">
                    Tus respuestas han sido enviadas exitosamente. Recibirás tu puntuación y retroalimentación pronto.
                  </p>
                  <Button
                    onClick={() => (window.location.href = "/student-dashboard")}
                    className="bg-blue-600 hover:bg-blue-700"
                  >
                    Volver al Panel
                  </Button>
                </div>
              )}
            </CardContent>
          </Card>
        )}
      </div>
    </div>
  )
}
